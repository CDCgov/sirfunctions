<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Generating Global Polio Data • sirfunctions</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generating Global Polio Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sirfunctions</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/sirfunctions.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/generate-polio-data.html">Generating Global Polio Data</a></li>
    <li><a class="dropdown-item" href="../articles/kpi-analysis.html">The KPI Analysis Pipeline</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generating Global Polio Data</h1>
            
      

      <div class="d-none name"><code>generate-polio-data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The Surveillance, Innovation, and Research (SIR) Team within the
Polio Eradication Branch at CDC obtains global polio data (referred to
in this guide as <code>polio_data</code>) from <a href="https://extranet.who.int/polis/Account/Login" class="external-link">POLIS</a>.
Collaborators outside of CDC who wish to pull global polio data using
the sirfunctions package must have access to POLIS beforehand, as well
obtain a POLIS API key.</p>
<p>All of the analysis conducted by the SIR team begin by creating a
global polio dataset. For those with CDC credentials, loading this
dataset can be as simple as running:</p>
<p><code>polio_data &lt;- sirfunctions::get_all_polio_data()</code></p>
<p>If you are a CDC employee, reach out to <strong>Stephanie
Kovacs</strong> at <a href="mailto:uvx4@cdc.gov" class="email">uvx4@cdc.gov</a> to ensure proper permissions are set for
loading <code>polio_data</code>.</p>
<p>This guide is tailored for collaborators, who may not have CDC
credentials, but do have access to data in POLIS.</p>
</div>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<div class="section level3">
<h3 id="data-folder-setup">Setting up the data folder<a class="anchor" aria-label="anchor" href="#data-folder-setup"></a>
</h3>
<p>In your local machine, preferably in the Desktop, create a folder
called <code>polio_data</code>. Within this folder, create three
subdirectories: <code>coverage</code>, <code>spatial</code>, and
<code>pop</code>. These folders contain datasets required to build the
global polio dataset <code>polio_data</code>.</p>
<div class="section level4">
<h4 id="coverage-folder">coverage folder<a class="anchor" aria-label="anchor" href="#coverage-folder"></a>
</h4>
<p>The vaccine coverage information are sourced from <a href="https://www.healthdata.org/research-analysis/health-risks-issues/vaccine-coverage-data" class="external-link">IHME</a>.To
access the data folder and download vaccine coverage data, you need to
enter an email and agree to the terms and conditions of use. The folder
must contain the following files:</p>
<ol style="list-style-type: decimal">
<li>
<code>dpt.rds</code>: vaccine coverage estimates of the DPT
vaccine.</li>
<li>
<code>mcv1.rds</code>: vaccine coverage estimates of the MCV1
vaccine.</li>
</ol>
<p>The SIR team maintains these files. Please request these files from
Stephanie Kovacs. Details on how to build these <code>.Rds</code> files
are located in the Index section called <a href="#build-coverage">Building the coverage datasets</a>.</p>
</div>
<div class="section level4">
<h4 id="spatial-folder">spatial folder<a class="anchor" aria-label="anchor" href="#spatial-folder"></a>
</h4>
<p>The spatial folder requires five files to be present:</p>
<ol style="list-style-type: decimal">
<li>
<code>global.ctry.rds</code>: global country shapefiles</li>
<li>
<code>global.prov.rds</code>: global province shapefiles</li>
<li>
<code>global.dist.rds</code>: global district shapefiles</li>
<li>
<code>roads.rds</code>: lines outlining roads</li>
<li>
<code>cities.rds</code>: coordinates of city centroids</li>
</ol>
<p><span style="color:darkgrey"> <strong><em>Building the global
geographic shapefiles</em></strong> </span></p>
<p>These are built from the polio geodatabase maintained at the World
Health Organization (WHO). It will be a <code>.gdb</code> file, which is
an ESRI GeoDatabase file. Please request this file from
<strong>Oluwadamilola Obafemi Sonoiki</strong> at <a href="mailto:sonoikio@who.int" class="email">sonoikio@who.int</a>.</p>
<p>To build the three global geographic spatial files, please install <a href="https://github.com/nish-kishore/tidypolis" class="external-link">tidypolis</a>. Once
tidypolis is installed, run the following lines:</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tidypolis</span><span class="op">)</span></span>
<span><span class="fu">preprocess_spatial</span><span class="op">(</span></span>
<span>gdb_folder <span class="op">=</span> <span class="st">"path/to/gdb_file.gdb"</span>, <span class="co"># replace with real path to the GDB file</span></span>
<span>output_folder <span class="op">=</span> <span class="st">"path/to/data/spatial"</span>, <span class="co"># replace with real path to the spatial folder</span></span>
<span>edav <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre>
<p>Upon completion, the <code>spatial</code> folder should contain the
following three spatial files as well as some diagnostic files,
including duplicate GUIDS and geographic names, as well as duplicated
shapes.</p>
<p><span style="color:darkgrey"> <strong>Building the roads rds
file</strong></span></p>
<p>This file is maintained by the SIR team. Please request this file
from <strong>Stephanie Kovacs</strong>. Details on building the roads
<code>.Rds</code> file is in the Index section called <a href="#build-roads">Building the roads dataset</a>.</p>
<p><span style="color:darkgrey"> <strong><em>Building the cities rds
file</em></strong> </span></p>
<p>This file is maintained by the SIR team. Please request this file
from <strong>Stephanie Kovacs</strong>. Details on building the roads
<code>.Rds</code> file is in the Index section called <a href="#build-cities">Building the cities dataset</a>.</p>
</div>
<div class="section level4">
<h4 id="pop-folder">pop folder<a class="anchor" aria-label="anchor" href="#pop-folder"></a>
</h4>
<p>The pop folder contains country, province, and district level
population counts. It comes from several sources. Due to the complexity
of building the population files, please reach out directly to
<strong>Stephanie Kovacs</strong> for the population files and place
this in the pop folder. Please see the index</p>
</div>
</div>
<div class="section level3">
<h3 id="polis-data">POLIS data<a class="anchor" aria-label="anchor" href="#polis-data"></a>
</h3>
<p>We source several information from POLIS, including case,
environmental surveillance, and immunization activity (SIA) data and
perform several data cleaning steps for each source, which the SIR team
refers to as “preprocessing of POLIS datasets.” The <a href="https://github.com/nish-kishore/tidypolis" class="external-link">tidypolis</a> package
is required for preprocessing. In general, preprocessing involves the
following steps to be followed in sequential order:</p>
<ol style="list-style-type: decimal">
<li>Initialize preprocessing via
<code>tidypolis::init_tidypolis()</code>. This involves designating a
folder in your local machine to store the POLIS data. We recommend
creating a folder called <code>POLIS</code> in your desktop. The first
time this function is ran, it will ask for a POLIS API key. Please
ensure that you have a POLIS API key beforehand.</li>
<li>Get all the POLIS tables via
<code>tidypolis::get_polis_data()</code>.</li>
<li>Run the preprocessing pipeline via
<code>tidypolis::preprocess_data(type = "cdc")</code>. Only
<code>type = "cdc"</code> is supported at this time.</li>
</ol>
<p>To ensure comparable data as those produced by the SIR team, please
use the following schedule:</p>
<ol style="list-style-type: decimal">
<li>Download of POLIS tables (step 2): Tuesdays at 6:00PM Eastern
Time.</li>
<li>Running preprocessing (step 3): Wednesdays at 9:00AM Eastern
Time.</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="creating-polio_data-locally">Creating <code>polio_data</code> locally<a class="anchor" aria-label="anchor" href="#creating-polio_data-locally"></a>
</h2>
<p>Once the data folder is set up and preprocessing is complete, we now
have all the required data to build <code>polio_data</code>. Creating
<code>polio_data</code> locally is done through
<code><a href="../reference/get_all_polio_data.html">get_all_polio_data()</a></code>.</p>
<div class="section level3">
<h3 id="first-run">First run<a class="anchor" aria-label="anchor" href="#first-run"></a>
</h3>
<p>There are four required arguments to pass onto
<code><a href="../reference/get_all_polio_data.html">get_all_polio_data()</a></code> when building <code>polio_data</code>
locally:</p>
<ol style="list-style-type: decimal">
<li>
<code>data_folder</code>: This is the absolute path to the
<code>polio_data</code> folder built in the <a href="#data-folder-setup">Setting up the data folder</a> section.</li>
<li>
<code>polis_folder</code>: This is the absolute path to the POLIS
folder containing the preprocessed data produced in the <a href="#polis-data">POLIS data</a> section. In the first run, it will
transfer all the preprocessed datasets from the POLIS folder unto a
folder called <code>polis</code> within the data folder.</li>
<li>
<code>use_edav</code>: set this to <code>FALSE</code>. The SIR team
stores <code>polio_data</code> in an Azure Datalake within the CDC
Enterprise Data, Analytics, and Visualization (EDAV) platform.</li>
<li>
<code>recreate.static.files</code>: set this to <code>TRUE</code>.
This will create another folder called <code>analytics</code> within the
data folder. This stores the cached polio data and spatial data
<code>.Rds</code> files. The spatial data <code>.Rds</code> file has the
country, province, and district shapefiles.</li>
</ol>
<p>Now, run the following line:</p>
<pre><code><span><span class="va">polio_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_all_polio_data.html">get_all_polio_data</a></span><span class="op">(</span></span>
<span>data_folder <span class="op">=</span> <span class="st">"C:/Users/ABC1/path/to/data_folder"</span>, <span class="co"># replace with actual path</span></span>
<span>polis_folder <span class="op">=</span> <span class="st">"C:/Users/ABC1/path/to/polis_folder"</span>, <span class="co"># replace with actual path</span></span>
<span>use_edav <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>recreate.static.files <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>
<p>You have now successfully built <code>polis_data</code>!</p>
</div>
<div class="section level3">
<h3 id="ensuring-polio_data-is-updated">Ensuring <code>polio_data</code> is updated<a class="anchor" aria-label="anchor" href="#ensuring-polio_data-is-updated"></a>
</h3>
<p>In future runs of <code><a href="../reference/get_all_polio_data.html">get_all_polio_data()</a></code>, you only need to
specify the parameters for <code>data_folder</code>,
<code>polis_folder</code>, and <code>use_edav</code>.</p>
<p>However, it is important to make sure to run
<code><a href="../reference/get_all_polio_data.html">get_all_polio_data()</a></code> with
<code>recreate.static.files = TRUE</code> preferable right after
completing the preprocessing of POLIS data. This will ensure the data
cache located in the <code>analytics</code> folder remains updated.</p>
</div>
<div class="section level3">
<h3 id="arguments-of-interest-within-get_all_polio_data">Arguments of interest within <code>get_all_polio_data()</code><a class="anchor" aria-label="anchor" href="#arguments-of-interest-within-get_all_polio_data"></a>
</h3>
<p>You can choose to exclude spatial data within <code>polio_data</code>
by setting <code>attach.spatial.data = FALSE</code>. You can also choose
to download pre-2019 data by setting <code>size = "medium"</code> for
data 2016-present or <code>size = "large"</code> for data 2001-present,
although these depend on whether the data obtained from running
<code>tidypolis::get_polis_data()</code> contain them.</p>
</div>
<div class="section level3">
<h3 id="filtering-polio_data-for-a-specific-country">Filtering <code>polio_data</code> for a specific country<a class="anchor" aria-label="anchor" href="#filtering-polio_data-for-a-specific-country"></a>
</h3>
<p>You can filter <code>polio_data</code> to only contain values for a
specific country by running:
<code>ctry_data &lt;- sirfunctions::extract_country_data("country name", polio_data)</code></p>
</div>
</div>
<div class="section level2">
<h2 id="index">Index<a class="anchor" aria-label="anchor" href="#index"></a>
</h2>
<div class="section level3">
<h3 id="population-file-processing">Population file processing<a class="anchor" aria-label="anchor" href="#population-file-processing"></a>
</h3>
<p>Population files are built for global districts, provinces and
countries, and are anchored to the latest release of WHO’s global
geodatabase.</p>
<p>When creating population files they are created in the following
order: Districts -&gt; Provinces -&gt; Countries</p>
<div class="section level4">
<h4 id="district-populations">District Populations<a class="anchor" aria-label="anchor" href="#district-populations"></a>
</h4>
<p>CDC creates district populations from WHO district population
estimates and then uses a variety of patches from other data sources to
fill in missingness.</p>
<p>Data sources: - WHO population estimates from 2015, 2019, 2020, 2021,
2022 and 2024 - additional patches received: 2018 Kenya patch,
supplemental WHO 2018 - 2022 population file, 2021/22 Pakistan
population file from CDC Pakistan team, Somalia 2022-2024 patch from
EMRO team - POLIS API population data</p>
<p>Methods: 1. Use all WHO provided extracts to create a dataframe that
is 2015 – 24 pops 2. Then patch in missingness with the Pakistan and
Somalia patches 3. Determine Anchor Year by identifying the max year for
which each adm2GUID has a population number 3a. Then patch in Kenya and
attach to shapes – Kenyan pops aren’t assigned to adm2GUIDs but rather
district name and year so we only use when missing data. Note: attaching
to shapes is key in this process because population files need to be
compatible with WHO global district shapes 4. Attach to growth rates
(growth rates can be obtained by contacting <strong>Stephanie
Kovacs</strong>) and fill using that rate from the max year’s pop number
5. After growth rate has been applied, determine which districts are
missing pops and join in the supplemental WHO file 5a. Use the growth
rate again but only apply to districts that are missing data and haven’t
been filled in by previous extracts and patches. This fills in places
where we either aren’t provided data in a WHO extract or for which we
are provided data but with an expired GUID or when a shape changes
between years so the growth factor is not applied 6. Repeat steps 5 and
5a but using POLIS population data from the API</p>
<p>Assumptions/miscellaneous: - WHO file is assumed to be the “golden
record”. Only patching when the original methodology leaves a district
with a missing pop that is in one of the patch files - Datasource types
(if a population for a given year is based on the growth factor being
applied that records inherits the datasource from the anchor year, this
is also the hierarchy of data, 1. worldpop/WHO, 2. Pakistan, Somalia and
Kenya Patches, 3. WHO patch, 4. POLIS API)</p>
</div>
<div class="section level4">
<h4 id="province-populations">Province Populations<a class="anchor" aria-label="anchor" href="#province-populations"></a>
</h4>
<p>Similar to distict populations, provinces start off using WHO
population estimates and then patch from other sources and apply a
growth factor.</p>
<p>Data sources: - WHO extracts from 2020, 2021, 2022 and 2024 - POLIS
indicators (NPAFP rate indicator) 2023 - District roll-ups from
dist.pop.long (created in district population processing)</p>
<p>Methods: 1. Use all WHO extracts to create a dataframe that is 2020 –
2024 2. Use extracts to determine a max anchor year for each adm1guid
and use growth factor to fill forwards and backwards for those shapes 3.
After using WHO extracts, we identify shapes with missing pops and use
the POLIS NPAFP indicator denominators to fill and apply the growth
factor on those shapes with missing pops 4. Finally, for any adm1guids
still missing pops, use the district pop file to roll up numbers (as
long as districts aren’t missing data) to fill adm1guid pop numbers (no
growth factor applied here)</p>
<p>Assumptions/miscellaneous: - Hierarchy of data sources: 1. WHO
extracts, 2. POLIS npafp rate indicators 2023, 3. district roll ups from
dist.pop.long only in cases where pop is missing after other sources
have been used to apply growth rates where applicable</p>
</div>
<div class="section level4">
<h4 id="country-populations">Country Populations<a class="anchor" aria-label="anchor" href="#country-populations"></a>
</h4>
<p>Country populations are unique to districts and provinces, rather
than use WHO estimates, UN population figures are used.</p>
<p>Data source: UN World Population Prospectus</p>
<p>Methods: 1. UN numbers pulled from their data portal API for all
geographies 2010 – 2025 2. Using “median” population variant from UN
file to determine each county pop 2010-2025 2a. Correct some country
names to conform with shape files</p>
</div>
</div>
<div class="section level3">
<h3 id="build-coverage">Building vaccine coverage datasets<a class="anchor" aria-label="anchor" href="#build-coverage"></a>
</h3>
<p>Method will be included soon. In the mean time, please request this
dataset from Stephanie Kovacs.</p>
</div>
<div class="section level3">
<h3 id="build-roads">Building the roads dataset<a class="anchor" aria-label="anchor" href="#build-roads"></a>
</h3>
<p>Method will be included soon. In the mean time, please request this
dataset from Stephanie Kovacs.</p>
</div>
<div class="section level3">
<h3 id="build-cities">Building the cities dataset<a class="anchor" aria-label="anchor" href="#build-cities"></a>
</h3>
<p>Method will be included soon. In the mean time, please request this
dataset from Stephanie Kovacs.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nishant Kishore, Mervin Keith Cuadera, Nicholas Heaghney, Elizabeth Krow-Lucal, Smita Chavan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
